<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart</title>
    <link rel="stylesheet" href="static/styles.css">
</head>
<body>
    <h1>Your Cart</h1>

    <!-- Cart items will be dynamically injected here -->
    <ul id="cart-items"></ul>

    <!-- Total cart price will be displayed here -->
    <h3 id="total-price">Total Cart Price: $0.00</h3>

    <!-- Buttons for clearing the cart and continuing shopping -->
    <button onclick="clearCart()">Clear All</button>
    <button onclick="window.location.href='catalogue.html'">Continue Shopping</button>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            displayCart();
        });

        // Function to fetch cart data from localStorage and display it
        function displayCart() {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            const cartItemsList = document.getElementById("cart-items");
            const totalPriceElement = document.getElementById("total-price");

            cartItemsList.innerHTML = "";  // Clear previous items
            let totalPrice = 0;

            cart.forEach((wine, index) => {
                const listItem = document.createElement("li");
                listItem.innerHTML = `
                    <h3>${wine.title}</h3>
                    <p><strong>Price:</strong> $${wine.price.toFixed(2)}</p>
                    <p><strong>Variety:</strong> ${wine.variety}</p>
                    <p><strong>Winery:</strong> ${wine.winery}</p>
                    <p><strong>Quantity:</strong> ${wine.quantity}</p>
                    <p><strong>Total Price for this item:</strong> $${wine.totalPrice.toFixed(2)}</p>
                    <button onclick="removeItem(${index})">Remove One</button>
                `;
                cartItemsList.appendChild(listItem);
                totalPrice += wine.totalPrice;  // Add item total to total price
            });

            totalPriceElement.innerHTML = `Total Cart Price: $${totalPrice.toFixed(2)}`;
        }

        // Remove one item from the cart (by index)
        function removeItem(index) {
            let cart = JSON.parse(localStorage.getItem('cart')) || [];
            if (cart[index].quantity > 1) {
                cart[index].quantity--;
                cart[index].totalPrice = cart[index].price * cart[index].quantity;
            } else {
                cart.splice(index, 1);  // Remove item if quantity is 1
            }
            localStorage.setItem('cart', JSON.stringify(cart));
            displayCart();  // Refresh the cart
        }

        // Clear the entire cart
        function clearCart() {
            localStorage.removeItem('cart');
            displayCart();  // Refresh after clearing
        }
    </script>
</body>
</html>
